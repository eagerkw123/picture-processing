!function(t,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?exports.pictureProcessing=n():t.pictureProcessing=n()}(window,(function(){return function(t){var n={};function e(i){if(n[i])return n[i].exports;var o=n[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,e),o.l=!0,o.exports}return e.m=t,e.c=n,e.d=function(t,n,i){e.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:i})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,n){if(1&n&&(t=e(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(e.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var o in t)e.d(i,o,function(n){return t[n]}.bind(null,o));return i},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},e.p="",e(e.s=0)}([function(t,n,e){"use strict";e.r(n);var i=e(1),o=e(2),a=e(3);n.default={image2css:i,image2base:o,image2cut:a}},function(t,n,e){var i=e(2),o="",a=[],c=function(t,n){var e=document.createElement("canvas");e.width=800,e.height=n;var i=e.getContext("2d"),a="",c="";t.forEach((function(t,n){var e=t.name,o=400/t.width*t.height;i.drawImage(t.image,400*n,0,400,o),a+=".".concat(e,","),c+=".".concat(e," {background-size: 200% auto; background-position: ").concat(100*n,"% 0}")})),o+="".concat(a.slice(0,a.length-1)," {background:url('").concat(e.toDataURL(),"') no-repeat} ").concat(c)};t.exports=function(t){var n=t.length,e=0,r=0;t.forEach((function(t){i(t).then((function(i){var l=t.slice(t.lastIndexOf("/")+1).split(".")[0];r++;var d=new Image;d.src=i.base64,a.push({image:d,name:l,width:i.width,height:i.height}),d.onload=function(){r+e===n&&function(){for(var t=Math.ceil(a.length/2),n=[],e=0;e<t;e++)n.push(a.splice(0,2));n.forEach((function(t,e){var i=parseInt(400/t[0].width*t[0].height),a=t.length>1?Math.max(i,parseInt(400/t[1].width*t[1].height)):i;if(c(t,a),e===n.length-1){var r=document.createElement("style");r.innerHTML=o,document.head.appendChild(r)}}))}()}})).catch((function(){e++}))}))}},function(t,n){t.exports=function(t){var n=new Image;return n.crossOrigin="",n.src=t,new Promise((function(e,i){n.onload=function(){var t,i,o,a;e({base64:(t=n,a=document.createElement("canvas"),a.width=i||t.width,a.height=o||t.height,a.getContext("2d").drawImage(t,0,0,a.width,a.height),a.toDataURL()),width:n.width,height:n.height})},n.onerror=function(){var n={e:"Picture does not exist: "+t};consolo.error(n.e),i(n)}}))}},function(t,n,e){function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var o,a,c,r,l,d,s,u,p,h,f,g,m,x,b,w=e(2),y=1,v=0,I=0,k=0,O=0,C=0,E="",M="",_="",T="",j=0,L=0,P=document.createElement("style"),S=document.createElement("section"),z=document.createElement("div"),H=document.createElement("p"),N=document.createElement("ul"),D=document.createElement("ul"),R=document.createElement("ul"),U=function(t){o=parseInt(window.innerWidth*y),(a=parseInt(o/u*p))<s&&(a=s,o=parseInt(a/p*u)),o<d&&(o=d,a=parseInt(o/u*p)),f=parseInt((window.innerWidth-o)/2),g=parseInt((window.innerHeight-a)/2),b||(b=[g+I,0,0,f+v]),E="margin:".concat(g+I,"px 0 0 ").concat(f+v,"px;width:").concat(o,"px"),M="margin:".concat(I+g-L,"px 0 0 ").concat(v+f-j,"px;width:").concat(o,"px"),_=_.replace(/marign:.*px/,""),T=T.replace(/marign:.*px/,""),c.style.cssText=_+E,r.style.cssText=T+M,u=o,p=parseInt(o/h),t&&!0},W=function(){if(_){var t=_.slice(_.indexOf("translate3d(")+12,_.indexOf("0)")).split(","),n=_.slice(_.indexOf("margin:")+7,_.lastIndexOf(";")).split(" ");3===t.length&&4===n.length&&(b=[parseInt(n[0])+parseInt(t[1]),0,0,parseInt(n[3])+parseInt(t[0])],E="margin:".concat(b[0],"px 0 0 ").concat(b[3],"px;width:").concat(o,"px"),c.style.cssText=E);var e=T.slice(T.indexOf("translate3d(")+12,T.indexOf("0)")).split(","),i=T.slice(T.indexOf("margin:")+7,T.lastIndexOf(";")).split(" ");3===e.length&&4===i.length&&(M="margin:".concat(parseInt(i[0])+parseInt(e[1]),"px 0 0 ").concat(parseInt(i[3])+parseInt(e[0]),"px;width:").concat(o,"px"),r.style.cssText=M),v=0,I=0}},X=function(t){var n=t.touches[0];k=n.pageX-v,O=n.pageY-I},Y=function(t){var n=t.touches[0],e=t.target,i=(_.replace(),parseInt(n.pageX-k)),r=parseInt(n.pageY-O);i=(i=i>=j-b[3]?j-b[3]:i)<=-(o+b[3]-d-j)/2?-(o+b[3]-d-j):i,r=(r=r>=L-b[0]?L-b[0]:r)<=-(a+b[0]-s-L)/2?-(a+b[0]-s-L):r,v=i,I=r,_="-webkit-transform:translate3d(".concat(i,"px,").concat(r,"px,0);").concat(E),T="-webkit-transform:translate3d(".concat(i,"px,").concat(r,"px,0);").concat(M),c.style.cssText=_,e.style.cssText=T},F=function(){W(),!1},q=function(t){var n=t.touches[0];C=n.pageX-x.offsetLeft},A=function(t){var n=t.touches[0],e=m-15,i=parseInt(n.pageX-C);i=(i=i<=0?0:i)>=e?e:i,x.style.left=i+"px",x.parentNode.children[0].style.width=i+"px",y=(i/e*1.5+.5).toFixed(2),U(1)},B=function(){if(!_){var t=E.slice(E.indexOf("margin:")+7,_.lastIndexOf(";")).split(" ");4===t.length&&(b=[parseInt(t[0]),0,0,parseInt(t[3])])}W()},G=function(){document.head.removeChild(P),document.body.removeChild(S)},J=function(t,n,e){t.addEventListener(n,(function(t){e&&e(t),t.preventDefault(),t.stopPropagation()}),!1)},K=function(t){u=c.width,p=c.height,h=u/p,j=parseInt((o-d)/2),L=parseInt((a-s)/2),S.appendChild(c),H.appendChild(r),U(),J(r,"touchstart",X),J(r,"touchmove",Y),J(r,"touchend",F),x=D.children[1].children[1],m=x.parentNode.offsetWidth;var n=(y-.5)/1.5*m;n=Math.min(n,m-15),J(x,"touchstart",q),J(x,"touchmove",A),J(x,"touchend",B),x.style.left=n+"px",x.parentNode.children[0].style.width=n+"px",S.removeChild(N),H.style.opacity=1,J(R.children[0],"touchstart",(function(){!function(t){var n=document.createElement("canvas");n.width=o,n.height=a,n.getContext("2d").drawImage(c,0,0,o,a);var e=n.toDataURL(),i=new Image;i.src=e,i.onload=function(){var n=document.createElement("canvas"),e=Math.abs(b[3]-j),o=Math.abs(b[0]-L);n.width=d,n.height=s,n.getContext("2d").drawImage(i,e,o,d,s,0,0,d,s);var a=n.toDataURL("image/jpeg",.8);G(),t&&t(a)}}(t)})),J(R.children[1],"touchstart",(function(){t&&t(),G()}))};t.exports=function(t){var n,e,u=i(t);return o=window.innerWidth,a=window.innerHeight,l="string"===u?t:t.url,d="string"===u?o/2:t.width||o/2,d=Math.min(o,parseInt(d)),s="string"===u?d:t.height||d,s=Math.min(window.innerHeight,parseInt(s)),H.style.cssText="width: ".concat(d,"px;height: ").concat(s,"px;"),n="image-2-cut-box",e="position:fixed;left:0;top:0;width:100%;height:100%;",P.innerHTML=".image-2-cut-fixed {".concat(e,"}\n\t.").concat(n," {z-index: ").concat(1e4,";background: #fff;font-size: 20px}.").concat(n," img {display: block}.").concat(n," ul {list-style-type:  none}\n\t.").concat(n,"::after {content: '';display: block;z-index:").concat(10002,";").concat(e,"background: rgba(0, 0, 0, 0.6)}\n\t.").concat(n," div {z-index:").concat(10003,";").concat(e,"}\n\t.").concat(n," div p {position: absolute;left: 50%;top: 50%;transform: translate3d(-50%, -50%, 0);overflow: hidden;background: #000}\n\t.").concat(n," .cut-2-loading {position: absolute;z-index:").concat(10005,"; left: 50%;top: 50%;transform: translate3d(-50%, -50%, 0);height: 30px}\n\t.").concat(n," .cut-2-loading li {display: inline-block; width: 10px;height: 10px;margin-right: 6px;border-radius: 50%;background: #fff;animation: cut_2_li 1s 0s infinite}\n\t.").concat(n," .cut-2-loading li:nth-child(2) {animation: cut_2_li 1s 0.2s infinite}\n\t.").concat(n," .cut-2-loading li:nth-child(3) {animation: cut_2_li 1s 0.4s infinite}\n\t.").concat(n," .cut-2-loading li:nth-child(4) {animation: cut_2_li 1s 0.6s infinite}\n\t.").concat(n," .cut-2-do {position: absolute;left: 0;width: 100%;bottom: 3%;text-align:center;height: 36px; line-height: 36px;font-size: 14px}\n\t.").concat(n," .cut-2-do li:last-child{background: #999; color: #666}\n\t.").concat(n," .cut-2-do li {background: #fff;width: 120px;display: inline-block;margin: 0 8px;border-radius: 10px;color: #333}\n\t.").concat(n," .cut-2-scale {position: absolute;left: 0;top: 30px;height: 36px;width: 100%;text-align: center;z-index:").concat(10004,"}.").concat(n," .cut-2-scale li{display: inline-block;}\n\t.").concat(n," .cut-2-scale li:first-child, .").concat(n," .cut-2-scale li:last-child {box-sizing:border-box;width: 32px;height: 32px;color: #fff;line-height: 30px}\n\t.").concat(n," .cut-2-scale li:nth-child(2) {width: 60%;margin: 0 5%;height: 10px;background: #ccc;border-radius: 20px;transform: translate3d(0, -4px, 0)}\n\t.").concat(n," .cut-2-scale li:nth-child(2) p {position: absolute;width: 100%;left: 0;top: 0;width: 0;background: #fff;height: 100%;border-radius: 20px}\n\t.").concat(n," .cut-2-scale li:nth-child(2) b {position: absolute;width: ").concat(30,"px;height: ").concat(30,"px;border-radius: 50%;left: 0;top: -10px;display: block;background: #999}\n\t@-webkit-keyframes cut_2_li {0%, 100% {transform: translate3d(0, -100%, 0);opacity: 0} 30% {transform: translate3d(0, 0, 0);opacity: 1} 60% {transform: translate3d(0, 100%, 0);opacity: 0}}\n\t"),S.className="image-2-cut-fixed "+n,document.body.appendChild(S),S.appendChild(z),S.appendChild(D),z.appendChild(H),z.appendChild(R),D.className="cut-2-scale",D.innerHTML="<li>-</li><li><p></p><b></b></li><li>+</li>",R.className="cut-2-do",R.innerHTML="<li>确定</li><li>取消</li>",N.className="cut-2-loading",N.innerHTML="<li></li><li></li><li></li><li></li>",H.style.opacity=0,S.appendChild(N),document.head.appendChild(P),new Promise((function(t,n){w(l).then((function(e){l=e.base64,(c=new Image).src=l,(r=new Image).src=l,c.onload=function(){K((function(e){e?t(e):n({error:"用户取消了操作"})}))}})).catch((function(t){n({error:"图片加载失败，请确认图片路径是否正确"})})),J(S,"touchmove")}))}}]).default}));